---
title: Azure AI Content Understanding Retrieval Augmented Generation Concept
titleSuffix: Azure AI services
description: Learn about Retrieval Augmented Generation
author: laujan
ms.author: tonyeiyalla
manager: nitinme
ms.service: azure-ai-content-understanding
ms.topic: overview
ms.date: 03/16/2025
ms.custom: 2025-understanding-release
---
# Retrieval Augmented Generation with Content Understanding

# Introduction
Retrieval-Augmented Generation (RAG) is a design pattern that enhances the quality of responses generated by large language models (LLMs) by using external sources of knowledge to supplement the LLM's internal representation of information. This approach allows LLMs to access the most up-to-date and reliable facts from a knowledge base or internal information storage. 

Azure AI Content Understanding utilizes Generative AI to transform unstructured documents, images, videos, and audio into structured data, which is essential for Retrieval-Augmented Generation. Structured outputs ensure efficient, accurate retrieval of relevant information, leading to high-quality, contextually appropriate responses. Additionally, Content Understanding includes confidence scores and grounding to improve the reliability and credibility of the information, resulting in more coherent outputs.

:::image type="content" source="../media/concepts/RAGarchitecture.png" alt-text="Screenshot of Content Understanding RAG architecture overview, process, and workflow with Azure AI Search and Azure Open AI.":::

## Semantic Chunking with Content Understanding
Semantic chunking breaks down content into meaningful segments, crucial for Retrieval-Augmented Generation. This technique allows precise, efficient information retrieval by leveraging contextual data, ultimately enhancing the accuracy and coherence of generated responses. By structuring documents according to logical boundaries like sections and paragraphs, semantic chunking organizes large data volumes into manageable pieces, accelerating the retrieval process while ensuring relevance and reliability.

Azure AI Content Understanding is meticulously designed to support Retrieval-Augmented Generation use cases, offering robust capabilities for processing and understanding diverse content types. With Markdown output available for documents, images, audio, and video, users can seamlessly integrate structured and readable content into their workflows. 
* For document content, Azure AI Content Understanding provides structured document segments to align with contextual breaks like sections, paragraphs, or tables. You can use the Markdown content from Layout model to split documents based on paragraph boundaries, create specific chunks for tables, and fine-tune your chunking strategy to improve the quality of the generated responses.
* For audio content, Azure AI Content Understanding provides advanced transcription services, diarization, and speaker role detection, enabling precise identification and segmentation of spoken content. This allows for the extraction of meaningful audio segments, facilitating effective semantic chunking. 
* For video content, Azure AI Content Understanding offers scene summaries, key frame extraction, and shot detection, which helps in breaking down video data into coherent and contextually relevant segments.

The image below illustrates the page elements and content that Content Understanding extracts from documents with Layout analysis, showcasing Content Understandingâ€™s capability to provide a structured representation of extracted regions of interest and their inter-relationships. 

:::image type="content" source="../media/concepts/layoutpageelements.png" alt-text="Screenshot of Content Understanding Document Data Extraction with Layout Analysis for RAG design.":::

The image below exemplifies how structured data can be meticulously extracted from audio files using a customized schema uniquely designed to meet specific requirements. This structured format facilitates efficient organization, indexing, and searching of content.

:::image type="content" source="../media/concepts/audiorag.png" alt-text="Screenshot of Content Understanding Audio Data Extraction for RAG design":::

## Building a RAG Solution and Chat with Content Understanding
**Data Extraction with Azure Content Understanding:** Azure AI Content Understanding efficiently converts unstructured documents, images, videos, and audio into structured data formats. Documents are transformed into structured data, distinguishing between tables, paragraphs, sections, and figures. Audio is transcribed with precise timestamps and speaker labels, while video content is transcribed, summarized with key frames, descriptions, and relevant metadata. 

### Chunking document results
If you're looking for a specific section in a document, you can use semantic chunking to divide the document into smaller chunks based on the section headers helping you to find the section you're looking for quickly and easily:

``` python

from langchain_text_splitters import MarkdownHeaderTextSplitter
from langchain_text_splitters import RecursiveCharacterTextSplitter

# Configure langchain text splitting settings
EMBEDDING_CHUNK_SIZE = 512
EMBEDDING_CHUNK_OVERLAP = 20
headers_to_split_on = [
    ("#", "Header 1"),
    ("##", "Header 2"),
    ("###", "Header 3")
]

# First split text using Markdown headers
text_splitter = MarkdownHeaderTextSplitter(headers_to_split_on=headers_to_split_on, strip_headers=False)
chunks = text_splitter.split_text(document_content)

# Then further split the text using recursive character text splitting
char_text_splitter = RecursiveCharacterTextSplitter(separators=["<!--", "\n\n", "#"], chunk_size=EMBEDDING_CHUNK_SIZE, chunk_overlap=EMBEDDING_CHUNK_OVERLAP, is_separator_regex=True)
chunks = char_text_splitter.split_documents(chunks)

print("Number of chunks: " + str(len(chunks)))
```
> [!div class="nextstepaction"]
> [View samples on GitHub.](https://github.com/Azure-Samples/azure-ai-content-understanding-python)

For more information, our comprehensive [analyzer templates](analyzer-templates.md) offer a streamlined approach for transforming unstructured data into structured data formats. These templates facilitate the creation of efficient analyzers without the need to design schemas from scratch. Explore our [**code samples**](https://github.com/Azure-Samples/azure-ai-content-understanding-python) for simple demos on extracting data from multimodal files.

**Indexing with Azure AI Search and Querying with Azure OpenAI Service:** Once data is structured, [**Azure AI Search**](https://learn.microsoft.com/en-us/azure/search/search-get-started-portal) can create a comprehensive, searchable index and [**Azure OpenAI's**](https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/models?tabs=global-standard%2Cstandard-chat-completions) chat models can efficiently query and search through indexed content, providing accurate and contextually relevant answers. 

### Retrieving Chunks based on a question
If you're looking for a specific section in a document, you can use semantic chunking to divide the document into smaller chunks based on the section headers helping you to find the section you're looking for quickly and easily:

``` python

# Retrieve relevant chunks based on the question

retriever = vector_store.as_retriever(search_type="similarity", search_kwargs={"k": 3})

retrieved_docs = retriever.get_relevant_documents(
    "<your question>"
)

print(retrieved_docs[0].page_content)

# Use a prompt for RAG that is checked into the LangChain prompt hub (https://smith.langchain.com/hub/rlm/rag-prompt?organizationId=989ad331-949f-4bac-9694-660074a208a7)
prompt = hub.pull("rlm/rag-prompt")
llm = AzureChatOpenAI(
    openai_api_version="<Azure OpenAI API version>",  # e.g., "2023-12-01-preview"
    azure_deployment="<your chat model deployment name>",
    temperature=0,
)


def format_docs(docs):
    return "\n\n".join(doc.page_content for doc in docs)


rag_chain = (
    {"context": retriever | format_docs, "question": RunnablePassthrough()}
    | prompt
    | llm
    | StrOutputParser()
)
```

> [!div class="nextstepaction"]
> [View samples on GitHub.](https://github.com/Azure-Samples/azure-ai-search-with-content-understanding-python#samples)

For more information, see our [**code samples**](https://github.com/Azure-Samples/azure-ai-search-with-content-understanding-python#samples) demonstrating RAG pattern with Azure AI Content Understanding for structured data extraction, Azure Search for indexing and retrieval and querying data with OpenAI chat models.

## Benefits of Content Understanding for RAG Scenarios
Azure AI Content Understanding offers several capabilities that significantly enhance Retrieval-Augmented Generation (RAG) use cases:
* **Enhanced Content Processing:** With Markdown output for documents, images, audio, and video, Content Understanding ensures that content is structured and easily readable. This structured format aids in the efficient parsing and interpretation of content by AI models, leading to more accurate and relevant retrieval and generation of information.
* **Simplified field extraction:** Content Understanding's field extraction simplifies the process of generating structured output from unstructured content. By allowing users to define a schema, it becomes easier to extract, classify, or generate field values without the need for complex prompt engineering. This capability ensures that the data collected is organized and meaningful, facilitating more efficient processing and analysis
* **Confidence Scores and Grounding Sources:** By offering confidence scores for the extracted data, Content Understanding helps users estimate the reliability of the results. Grounding sources allow users to verify the correctness of the extracted information quickly. This feature is particularly beneficial for RAG use cases, as it ensures that the generated content is based on accurate and verifiable data. The combination of confidence scores and grounding sources enhances the trustworthiness of extracted output, leading to more reliable and actionable insights.

## Get started
Content Understanding supports the following development options:
* [REST API](../quickstart/use-rest-api.md) Quickstart.
* [Azure Foundry](../quickstart//use-ai-foundry.md) Portal Quickstart. 

## Next steps
* Learn more about [document](../document/overview.md), [image](../image/overview.md), [audio](../audio/overview.md), [video](../video/overview.md) capabilities.
* Learn more about Content Understanding [**best practices**](../concepts/best-practices.md) and [**capabilities**](../concepts/capabilities.md).
* Review Content Understanding [**code samples**](https://github.com/Azure-Samples/azure-ai-content-understanding-python/tree/main)
